<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Getting Started</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting Started</h1>



<div id="openeo-project" class="section level1">
<h1>openEO Project</h1>
<p>The openEO concept thrives in context of an ever increasing amount of
Earth Observation (EO) data. This leads to problems in managing,
analyzing and more importantly processing big amount of data by
researchers and companies. The core idea is to provide open-source tools
to interact with back-end (cloud) providers via an open API with a
predefined set of processes. Those processes are intended to manipulate
the underlying multidimensional data cubes as a data abstraction layer.
In this case, the back-end provider offers the EO data and the
processing infrastructure while the end-users provide the code for their
analysis. Therefore, different client software comes in handy to help
users during their production phase. There are currently openEO clients
for Python, JavaScript (web based), R and QGIS.</p>
<p>This description only scratches the surface of openEO. If you want to
dive deeper you can use the <a href="https://openeo.org">openEOs
official web page</a> as a point of reference or you get involved in the
various projects at <a href="https://github.com/Open-EO">Github</a>.</p>
</div>
<div id="openeo-r-client" class="section level1">
<h1>openEO R client</h1>
<p>As part of openEOs product range this client was developed to address
the R user community in order to give them access to openEO and to blend
the openEO concept into R and it’s commonly used IDE RStudio.</p>
<div id="package-goals-and-general-architecture" class="section level2">
<h2>Package Goals and General Architecture</h2>
<p>The openEO architecture is simply client-server based. The clients
communicate with the back-ends via static functions for exploring server
capabilities, data sets, processes or visualization services
(WMS,WFS,WCS) and for managing the calculation on the back-end. Then
there is also a degree of freedom regarding the tools / processes
provided by the back-end. Usually openEO back-ends adopt the <a href="https://processes.openeo.org/1.0.0/">predefined processes</a> that
aim to define a set of common processes for working with
multidimensional data cubes. On top of that provider might offer
additional processes to either boost their performance or ease
usability. When talking about client-server based processing, hardly any
processing is done by this package, but it will delegate the processing
to the back-end and ease your analysis workflow by offering a familiar
developing environment in R and RStudio.</p>
</div>
<div id="funding-acknowledgements" class="section level2">
<h2>Funding Acknowledgements</h2>
<p>The authors acknowledge the financial support for the development of
this package during the H2020 project “openEO” (Oct 2017 to Sept 2020)
by the European Union, funded by call EO-2-2017: EO Big Data Shift,
under grant number 776242. We also acknowledge the financial support
received from ESA for the project “R4openEO” (Sept 2021 to Sept
2022).</p>
<p>Furthermore, openEO was improved and operationalized by ESA funding
in the project “openEO Platform” (Sept 2020 to Sept 2022).</p>
</div>
<div id="disclaimer" class="section level2">
<h2>Disclaimer</h2>
<p>This software is free of charge. You can use it, distribute it and
improve it under the Apache2 license. In openEO exploration of services
and data is also free of charge in most cases. You can even start
developing your analysis with the processes provided by the back-end.
However, storing EO data and providing processing capabilities costs
money. This means that openEO providers might charge money for using
their infrastructure. Please inform yourselves about eventual costs. The
examples in this vignette are created with the openEO implementation for
Google Earth Engine (GEE). Provided processes and data sets will vary
among different platform providers. This means that you might not be
able to copy and paste the examples given here. This vignette serves the
purpose to explain how to interact with this package in order to execute
your analysis. Again, we would like to stress out that the heavy lifting
will be done by server back-ends and this package just offers the
functions to interact with the back-end in a “mostly” R familiar way.
Here and there you may find some “quirks” that are due to the generic
implementation of dynamically parsed collections and predefined
processes for any openEO back-end. However the “quirk” will be that you
might call processes that are registered at an R6 object the same way
you would call named fields in a list (see <code>processes()</code> in
“Executing and storing of user-defined processes”). Also, the examples
in this vignette will be reproducible, but it will not show any results
in the vignette. This is due to the interactive part, when dealing with
remote platforms - you will need access to them and we cannot share the
credentials publicly without explicit consent. The vignette guides you
on how to perform certain actions in openEO by providing code
examples.</p>
</div>
<div id="registration" class="section level2">
<h2>Registration</h2>
<p>As mentioned before, provider might charge money for accessing their
infrastructure and hence you would need to <a href="https://docs.egi.eu/users/aai/check-in/signup/">sign up with
EGI</a> first and then <a href="https://openeo.cloud/">enroll with
openEO Platform</a>. This setup is also targeted for the long run
(support of more recent openEO API versions). For a slightly older
version of the API (v1.0.0) you can use the Google Earth Engine driver
with limited capabilities. This system was developed and set up during
the H2020 openEO project and you can still access it with the link and
credentials provided at the <a href="https://github.com/Open-EO/openeo-earthengine-driver">openeo-earthengine-driver
project on Github</a> section “Demo”.</p>
</div>
<div id="connecting-to-backend" class="section level2">
<h2>Connecting to backend</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(openeo)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&quot;https://earthengine.openeo.org&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>con <span class="ot">=</span> <span class="fu">connect</span>(<span class="at">host=</span>url)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">capabilities</span>()</span></code></pre></div>
<p>As you can see, you can either omit the connection or you state it
explicitly via the parameter <code>con</code>. All static functions
designed to interact with any openEO back-end will have the connections
parameter where you are able to state the designated back-end
connection. If you omit it, R tries to get the most recent connection.
If you want to change the active connection and don’t want to pass the
connection to every single interaction function you can call an already
established connection with <code>active_connection()</code>.</p>
</div>
<div id="exploration-of-data-services-and-processes" class="section level2">
<h2>Exploration of data, services and processes</h2>
<p>The exploratory functions do not need a user to be registered or
signed-in and are free of costs. Typically, you might want to know which
collections and processes are implemented, as well as the available file
formats for export and the web services for integration in GIS or web
apps.</p>
<p>With the list_* functions you will get overviews of the elements.
Jobs, services and process graphs are bound to a user and require an
authentication. To get more detailed information on those objects, you
can use describe_* functions with their respective ID.</p>
<p>Objects stated in the list object and objects returned as detailed
information have the same class, but in the list view some information
are hidden. They are treated and printed in the same way.</p>
<p>List objects are S3-objects with dedicated <code>print()</code> and
<code>as.data.frame()</code> methods. This ensures that these objects
are printed as a data.frame or tibble.</p>
<p>Here are some examples on the collections:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">list_collections</span>()</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>colls <span class="ot">=</span> <span class="fu">list_collections</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">class</span>(colls)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">str</span>(colls<span class="sc">$</span><span class="st">`</span><span class="at">COPERNICUS/S2</span><span class="st">`</span>)</span></code></pre></div>
<p>As in the example before, you are advised to use auto-completion. In
this way you retrieve an object list such as collections or file formats
and are able to select a particular entry by its name. These lists are
very similar to named lists.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">describe_collection</span>(<span class="at">collection =</span> colls<span class="sc">$</span><span class="st">`</span><span class="at">COPERNICUS/S2</span><span class="st">`</span>)</span></code></pre></div>
<p>The processes are handled similarly. With
<code>list_processes()</code> you will get a list of process objects
which are visualized through a dedicated <code>print()</code> method.
The processes obtained here, are just for information purposes. For
process graph / workflow creation we will use <code>processes()</code>,
which creates process collection containing parametrized functions.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>process_list <span class="ot">=</span> <span class="fu">list_processes</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>process_list[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<p>In the example above you print the basic information about the
processes to the console. If you want to have a nicer visualization of
the process in HTML, you can use <code>process_viewer()</code>. Simply
pass the process name, function or process object to the function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">process_viewer</span>(<span class="at">x =</span> <span class="st">&quot;load_collection&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">process_viewer</span>(<span class="at">x=</span>process_list[<span class="dv">1</span>])</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">processes</span>()</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">process_viewer</span>(<span class="at">x=</span>p<span class="sc">$</span>load_collection)</span></code></pre></div>
<p>As beforehand you can access particular objects by their ID.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>process_list<span class="sc">$</span><span class="st">`</span><span class="at">if</span><span class="st">`</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>process_list<span class="sc">$</span><span class="st">`</span><span class="at">sum</span><span class="st">`</span></span></code></pre></div>
<p>File formats and service types can be obtained and visualized with
the previous functions. On a side note, you can also use those objects
when assigning the file format in the openEO process for
<code>save_results</code> or the service type when creating a particular
web service.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>formats <span class="ot">=</span> <span class="fu">list_file_formats</span>()</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">class</span>(formats)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>formats</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>formats<span class="sc">$</span>output<span class="sc">$</span>PNG</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">class</span>(formats<span class="sc">$</span>output<span class="sc">$</span>PNG)</span></code></pre></div>
<p>For formats we have to distinguish between supported input and output
formats. Output formats are used when serializing results and input
formats are used when aggregating data via polygons, creating a mask
from a geometry or potentially uploading a raster image as mask.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>service_types <span class="ot">=</span> <span class="fu">list_service_types</span>()</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>service_types</span></code></pre></div>
</div>
<div id="login" class="section level2">
<h2>Login</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>user <span class="ot">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>pwd <span class="ot">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">login</span>(<span class="at">user =</span> user,<span class="at">password =</span> pwd)</span></code></pre></div>
<p>Note: You might explore more data collections and processes once you
are registered and logged in. Without logging in you can just see the
free data sets that do not conflict with any terms of use.</p>
</div>
<div id="user-data" class="section level2">
<h2>User data</h2>
<p>As a registered user, you will have a dedicated file space for your
uploads (like a workspace), as well as the jobs and services linked to
your account. Further more you can explore your accounts quota in terms
of used and available disk space and credits.</p>
<div id="user-account" class="section level3">
<h3>User account</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">describe_account</span>()</span></code></pre></div>
</div>
<div id="file-workspace" class="section level3">
<h3>File workspace</h3>
<p>In your file space you can upload a variety of data. You can put here
all external data you need for your analysis. This can range from area
of interests, over scripts for user defined functions (UDF scripts) to
trained machine learning models that shall be applied on a larger
scale.</p>
<p>To get an overview of the uploaded files, you can use the
<code>list_*</code> function - in this case it is
<code>list_files()</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">list_files</span>()</span></code></pre></div>
<p>As an example for the upload, we will first download a temporary
GeoJSON file from the Github repository, then upload it using
<code>upload_file()</code> and lastly remove the temporary download
file. For a better workspace organization you can use subfolders as
<code>target</code> parameter. If the subfolder does not exist, it will
be created during the upload.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.json&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://raw.githubusercontent.com/Open-EO/openeo-r-client/master/examples/polygons.geojson&quot;</span>, <span class="at">destfile =</span> file)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>openeo<span class="sc">::</span><span class="fu">upload_file</span>(<span class="at">content=</span>file,<span class="at">target=</span><span class="st">&quot;aoi/polygons.json&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">file.remove</span>(file)</span></code></pre></div>
<p>Now, we call <code>list_files()</code> once more, and as you can see,
the file is now at the specific workspace location.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">list_files</span>()</span></code></pre></div>
<p>The <code>download_file()</code> function works inverse to the upload
and lets you retrieve the uploaded data.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>dl_file <span class="ot">=</span> <span class="fu">download_file</span>(<span class="at">src=</span><span class="st">&quot;aoi/polygons.json&quot;</span>, <span class="at">dst =</span> file)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">readChar</span>(dl_file,<span class="at">nchars =</span> <span class="fu">file.size</span>(dl_file)))</span></code></pre></div>
<p>The last function in this context is the <code>delete_file()</code>
function, which removes a specific file from the workspace.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">delete_file</span>(<span class="at">src =</span> <span class="st">&quot;aoi/polygons.json&quot;</span>)</span></code></pre></div>
<p>And now the workspace is empty. (If not maybe other users may have
left data on this demo account)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">list_files</span>()</span></code></pre></div>
</div>
</div>
<div id="creation-and-storage-of-user-defined-processes" class="section level2">
<h2>Creation and storage of user-defined processes</h2>
<p>The <code>ProcessCollection</code> is an object that returns the
processes available by <code>list_processes()</code> as functions of an
R6 object. Therefore, all parameter definitions and the process metadata
are evaluated and translated into functions in R. To create the
<code>ProcessCollection</code> use <code>processes()</code> during an
active openEO connection or specify a new one by making use of parameter
<code>con</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">processes</span>()</span></code></pre></div>
<p>Lets explore object <code>p</code> a bit further.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">class</span>(p)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">names</span>(p)</span></code></pre></div>
<p>Here you can see all the available processes on the openEO service.
The functions or fields in “.__enclos_env__“,”clone” and “initialize”
are R6-specific functions, whereas the others are dynamically added
functions. This means that when you connect to a different openEO
service the functions here might be different or they have different
parameter.</p>
<p>For comparison here are the processes listed in
<code>list_processes()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">list_processes</span>())</span></code></pre></div>
<p>“load_collection” is a key function since the data is selected for
further processing.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">class</span>(p<span class="sc">$</span>load_collection)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">formals</span>(p<span class="sc">$</span>load_collection)</span></code></pre></div>
<p>You can see that there are four defined parameters. They are
initialized with <code>NA</code>. More detailed information can be
obtained by using the <code>describe_process()</code>. By typing the
different arguments and evaluating the function you receive a
<code>ProcessNode</code> object. These are the building blocks of the
process graph / workflow.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">describe_process</span>(<span class="at">process =</span> <span class="st">&quot;load_collection&quot;</span>)</span></code></pre></div>
</div>
<div id="example-analysis-setup" class="section level2">
<h2>Example: Analysis setup</h2>
<p>Now I will present a simple use case on how to create your first
analysis using the openEO processes. First, please bear in mind, that
the initial data set has to be seen as a multidimensional data cube.
Such data cubes often consist of space (2 dimensions), time (another
dimension) and bands or maybe even the wavelengths or polarization (yet
another dimension). As main operations on data cubes we have reducers
and aggregation functions. These allow to get rid of a certain dimension
or restructure them by changing the spatial or temporal resolution. In
any case you need to define a function that handles the data
accordingly.</p>
<p>In the following example we will select a collection (Sentinel-2) and
with a certain spatial and temporal extent. Additionally, we filter the
bands, as we need just red and near-infrared wavelengths. Afterwards we
calculate the NDVI for each time step by reducing “bands” and stating
the NDVI band arithmetic function. Afterwards we will reduce the
temporal dimension by selecting the minimum NDVI value per “pixel” (x
and y coordinate). As the selected back-end offers PNG as an image
format, which we might need for a web service like WMS, we need to scale
the NDVI value range from (-1 to 1) to the PNG value range (0,255).
Lastly, we store the results as a PNG image.</p>
<p>In openEO terminology the defined analysis workflow will be called
“user defined process” (UDP).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>data <span class="ot">=</span> p<span class="sc">$</span><span class="fu">load_collection</span>(<span class="at">id =</span> colls<span class="sc">$</span><span class="st">`</span><span class="at">COPERNICUS/S2</span><span class="st">`</span>,</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>                             <span class="at">spatial_extent =</span> <span class="fu">list</span>(</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                               <span class="at">west=</span><span class="fl">16.1</span>,</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>                               <span class="at">east=</span><span class="fl">16.6</span>,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>                               <span class="at">north=</span><span class="fl">48.6</span>,</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>                               <span class="at">south=</span> <span class="fl">47.2</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>                             ),</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>                             <span class="at">temporal_extent =</span> <span class="fu">list</span>(</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>                               <span class="st">&quot;2018-04-01&quot;</span>, <span class="st">&quot;2018-05-01&quot;</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>                             ),</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>                             <span class="at">bands=</span><span class="fu">list</span>(<span class="st">&quot;B8&quot;</span>,<span class="st">&quot;B4&quot;</span>))</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>spectral_reduce <span class="ot">=</span> p<span class="sc">$</span><span class="fu">reduce_dimension</span>(<span class="at">data =</span> data, <span class="at">dimension =</span> <span class="st">&quot;bands&quot;</span>,<span class="at">reducer =</span> <span class="cf">function</span>(data,context) {</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>  b8 <span class="ot">=</span> data[<span class="dv">1</span>]</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>  b4 <span class="ot">=</span> data[<span class="dv">2</span>]</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>  </span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>  <span class="fu">return</span>((b8<span class="sc">-</span>b4)<span class="sc">/</span>(b8<span class="sc">+</span>b4))</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>})</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>temporal_reduce <span class="ot">=</span> p<span class="sc">$</span><span class="fu">reduce_dimension</span>(<span class="at">data=</span>spectral_reduce,<span class="at">dimension =</span> <span class="st">&quot;t&quot;</span>, <span class="at">reducer =</span> <span class="cf">function</span>(x,y){</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>  <span class="fu">min</span>(x)</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>})</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>apply_linear_transform <span class="ot">=</span> p<span class="sc">$</span><span class="fu">apply</span>(<span class="at">data=</span>temporal_reduce,<span class="at">process =</span> <span class="cf">function</span>(value,...) {</span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>  p<span class="sc">$</span><span class="fu">linear_scale_range</span>(<span class="at">x =</span> value, </span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>                           <span class="at">inputMin =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>                           <span class="at">inputMax =</span> <span class="dv">1</span>, </span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>                           <span class="at">outputMin =</span> <span class="dv">0</span>, </span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>                           <span class="at">outputMax =</span> <span class="dv">255</span>)</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>})</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>result <span class="ot">=</span> p<span class="sc">$</span><span class="fu">save_result</span>(<span class="at">data=</span>apply_linear_transform,<span class="at">format=</span>formats<span class="sc">$</span>output<span class="sc">$</span>PNG)</span></code></pre></div>
</div>
<div id="calculate-immediate-results" class="section level2">
<h2>Calculate immediate results</h2>
<p>For development and testing of the process graph you can use the
<code>compute_result</code> function. Please keep in mind that there
might be costs involved to these processes depending on the payment
plan. This process will block your command line until the calculations
are done and the results are sent. It is recommended to choose a small
data sample when using this function. It might also be the case that
some provider won’t allow UDF for this function. In cases where payments
are involved you have the possibility to set the payment plan and the
maximum amount of credits spent.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>temp <span class="ot">=</span> <span class="fu">tempfile</span>()</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>file <span class="ot">=</span> <span class="fu">compute_result</span>(<span class="at">graph =</span> result, <span class="at">output_file =</span> temp)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>r <span class="ot">=</span> raster<span class="sc">::</span><span class="fu">raster</span>(file)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">spplot</span>(r)</span></code></pre></div>
</div>
<div id="creating-a-job" class="section level2">
<h2>Creating a job</h2>
<p>In contrast to the synchronous execution of the user defined process
(UDP), you can also create a job at the back-end, which means that the
console is not blocked in the meantime. The job needs to be started in
order to perform the analysis and obtain the results.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>job <span class="ot">=</span> <span class="fu">create_job</span>(<span class="at">graph=</span>result,<span class="at">title =</span> <span class="st">&quot;Minimum NDVI&quot;</span>, <span class="at">description =</span> <span class="st">&quot;Minimum NDVI calculation on Sentinel-2 data, including a linear scaling into 0 to 255 and exporting as PNG file.&quot;</span>)</span></code></pre></div>
<p>In addition to the response message you can list your jobs and look
if the new job is listed.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>jobs <span class="ot">=</span> <span class="fu">list_jobs</span>()</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>jobs</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>jobs[[job<span class="sc">$</span>id]]</span></code></pre></div>
<p>Similarly to the process graph, <code>describe_job()</code> returns a
more detailed description of the job.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">describe_job</span>(<span class="at">job =</span> job)</span></code></pre></div>
<p>You can queue the job for execution by using
<code>start_job()</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">start_job</span>(<span class="at">job=</span>job)</span></code></pre></div>
<p>Now, we need to wait for the job to finish. We can get information on
the status either by the job list or by the job meta data.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">list_jobs</span>()</span></code></pre></div>
<p>When it is finished, we can inspect the results.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">list_results</span>(<span class="at">job=</span>job)</span></code></pre></div>
<p>In most cases we want to download the results.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>dir <span class="ot">=</span> <span class="fu">tempdir</span>()</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">download_results</span>(<span class="at">job=</span>job, <span class="at">folder =</span> dir)</span></code></pre></div>
<p>With the download function all result assets are downloaded into the
target folder.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">list.files</span>(dir)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">delete_job</span>(<span class="at">job=</span>job)</span></code></pre></div>
</div>
<div id="creating-a-service" class="section level2">
<h2>Creating a service</h2>
<p>If the openEO back-end supports the retrieval of results as a service
you can use this package to create one. For example, if you want to have
a WMS layer or a Web Map Tile service in leaflet, QGIS or mapview.</p>
<p>First, you can explore the different offered service types of the
back-end.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>service_types <span class="ot">=</span> <span class="fu">list_service_types</span>()</span></code></pre></div>
<p>Then you create a service similarly to the creation of a job. Here
you also need to state the kind of service to be created and whether or
not it shall be enabled.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>test_service <span class="ot">=</span> <span class="fu">create_service</span>(<span class="at">type =</span> service_types<span class="sc">$</span>xyz, <span class="at">graph =</span> result, <span class="at">title =</span> <span class="st">&quot;XYZ service for minimum EVI&quot;</span>, <span class="at">description =</span> <span class="st">&quot;XYZ service for minimum EVI from the getting_started guide.&quot;</span>,<span class="at">enabled =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The idea behind services is that you might want the analysis results
for a interactive web application for users to explore the data. The
back-end decides whether or not it caches the results or if it processes
the result on-the-fly.</p>
<p>As for the other endpoints, you are able to explore your services by
listing them, getting detailed information, updating and deleting.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">list_services</span>()</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">describe_service</span>(<span class="at">service =</span> test_service)</span></code></pre></div>
<p>As a practical use case for this we prepared a small web map example
with leaflet which uses the WMTS created before.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>(test_service<span class="sc">$</span>url, <span class="fu">tileOptions</span>(<span class="at">tms=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fl">16.363449</span>,<span class="at">lat=</span><span class="fl">48.210033</span>,<span class="at">zoom =</span> <span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="rstudio-specific-features" class="section level2">
<h2>RStudio specific features</h2>
<p>In this web page representation certain features cannot be shown, but
shall be mentioned, for you to try out in RStudio.</p>
<ul>
<li><code>process_viewer()</code>: opens the viewer panel and renders
the process information as HTML web page</li>
<li><code>collection_viewer()</code>: similar to
<code>process_viewer()</code>, but for collections</li>
<li><code>terms_of_service()</code>: also a web view of the terms of
service</li>
<li><code>privacy_policy</code>: web view of the privacy policy</li>
<li>connection contract implementation: creates a connection in the
connections pane for the openEO service</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
